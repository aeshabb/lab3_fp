# Лабораторная работа №3: Интерполяция

Беля Алексей 408256

## Установка и сборка

Требования:
- OCaml >= 4.14
- Dune >= 3.7

Сборка проекта:
```bash
dune build
```

Установка:
```bash
dune install
```

## Использование

Общий формат команды:
```bash
my_lab3 [опции] < input.txt
```

**Важно для интерактивного ввода с клавиатуры**: После ввода всех точек нажмите `Ctrl+D` (Linux/Mac) или `Ctrl+Z` + `Enter` (Windows) для завершения ввода. Подробнее см. [INTERACTIVE.md](INTERACTIVE.md).

### Опции командной строки

- `--linear` - использовать линейную интерполяцию (по умолчанию)
- `--newton` - использовать интерполяцию полиномом Ньютона
- `--step FLOAT` - шаг дискретизации (по умолчанию 1.0)
- `-n INT` - размер окна для интерполяции (по умолчанию 2)

Можно указывать несколько методов одновременно.

### Формат входных данных

Входные данные подаются на стандартный ввод в текстовом формате:
- Каждая строка содержит пару чисел: x и y
- Разделители: пробел, табуляция, точка с запятой или запятая
- Данные должны быть отсортированы по возрастанию x

Пример:
```
0 0
1 1
2 2
3 3
```

### Формат выходных данных

Программа выводит интерполированные точки в формат:
```
метод: x y
```

## Примеры использования

### Пример 1: Линейная интерполяция с шагом 0.7

```bash
echo -e "0 0\n1 1\n2 2\n3 3" | dune exec my_lab3 -- --linear --step 0.7
```

Вывод:
```
linear: 0 0
linear: 0.7 0.7
linear: 1.4 1.4
linear: 2.1 2.1
linear: 2.8 2.8
```

### Пример 2: Интерполяция Ньютона с окном 4 точки

```bash
echo -e "0 0\n1 1\n2 2\n3 3\n4 4\n5 5\n7 7\n8 8" | dune exec my_lab3 -- --newton -n 4 --step 0.5
```

### Пример 3: Несколько методов одновременно

```bash
echo -e "0 0\n1 1\n2 4\n3 9" | dune exec my_lab3 -- --linear --newton --step 0.5
```

### Пример 4: Использование файла с данными

Создайте файл `test_data.txt`:
```
0;0
1;1
2;4
3;9
4;16
```

Запустите:
```bash
cat test_data.txt | dune exec my_lab3 -- --newton -n 3 --step 0.5
```

## Архитектура программы

Программа организована в функциональном стиле с разделением на модули:

1. **Config** - парсинг аргументов командной строки
2. **Io** - ввод/вывод данных, работа с форматами
3. **Interpolation_alg** - алгоритмы интерполяции (линейная, Ньютона)
4. **Stream_processor** - потоковая обработка данных со скользящим окном
5. **Main** - главный модуль, интеграция всех компонентов

### Потоковая обработка

Программа работает в потоковом режиме:
- Читает данные построчно из stdin
- Использует скользящее окно заданного размера
- Вычисляет интерполированные значения по мере поступления данных
- Выводит результаты сразу на stdout

### Скользящее окно

Для алгоритмов, работающих с группой точек:
- Первое окно: интерполируется от начала до середины
- Промежуточные окна: интерполируется только центральная точка
- Последнее окно: интерполируется от середины до конца

Это обеспечивает максимальную точность интерполяции.

## Запуск тестов

```bash
# Тест 1: Линейная интерполяция
cat tests/examples/linear_test.txt | dune exec my_lab3 -- --linear --step 0.7

# Тест 2: Интерполяция Ньютона
cat tests/examples/newton_test.txt | dune exec my_lab3 -- --newton -n 4 --step 0.5

# Тест 3: Все методы
cat tests/examples/complex_test.txt | dune exec my_lab3 -- --linear --newton --step 0.25 -n 3

# Запуск всех тестов
bash tests/run_tests.sh
```

## Технические детали

- Язык: OCaml
- Система сборки: Dune
- Стиль: Функциональное программирование
- Алгоритмы:
  - Линейная интерполяция (по 2 точкам)
  - Полином Ньютона с разделенными разностями

## Лицензия

Учебный проект для курса "Функциональное программирование" ИТМО.
